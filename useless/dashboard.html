<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="shortcut icon" href="dashboard.svg" type="image/x-icon" />
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <title>Dashboard</title>
  </head>
  <body>
    <h1>Dashboard:</h1>
    <hr />
    <h3 id="BTS">Boxes to ship: 0</h3>
    <h3 id="CCTS">Certificates to ship: 0</h3>
    <h3 id="BRP">Boxes registration percent: 0%</h3>
    <hr />
    <h3>Overall profits:</h3>
    <h4 id="MP">Max: $0</h4>
    <h4 id="BP">Brian: $0</h4>
    <hr />
    <button onclick="NewLazyBox();">Create new LAZY BOX</button>
    <button onclick="BoxesShipped();">Boxes shipped</button>
  </body>
</html>
<script>
  function BoxesShipped() {
    Swal.fire({
      title: "Work in progress...",
    });
  }
  function NewLazyBox() {
    Swal.fire({
      title: "Enter customer's address",
      input: "text",
      showCancelButton: true,
      inputValidator: (value) => {
        if (!value) {
          return "You need to write something!";
        }
      },
    }).then((address) => {
      Swal.fire({
        title: "Enter customer's zipcode",
        input: "text",
        showCancelButton: true,
        inputValidator: (value) => {
          if (!value) {
            return "You need to write something!";
          }
        },
      }).then((zipcode) => {
        Swal.fire({
          title: "Enter customer's name",
          input: "text",
          showCancelButton: true,
          inputValidator: (value) => {
            if (!value) {
              return "You need to write something!";
            }
          },
        }).then((name) => {
          axios
            .post("https://lazy-box-server.herokuapp.com/addBox", {
              name: name.value,
              address: address.value,
              zipcode: zipcode.value,
            })
            .then(function (response) {
              Swal.fire({
                title: "Your new lazy box id is: " + response.data,
                icon: "success",
              });
            })
            .catch(function (error) {
              console.log(error);
            });
        });
      });
    });
  }

  axios
    .get("https://lazy-box-server.herokuapp.com/getDashboard")
    .then(function (response) {
      console.log(response.data);
      document.getElementById("BTS").innerHTML =
        "Boxes to ship: " + response.data.itemsToShip;

      document.getElementById("CCTS").innerHTML =
        "Certificates to ship: " + response.data.certificatesToShip;

      document.getElementById("BRP").innerHTML =
        "Boxes registration percent: " + Math.round(response.data.BRP) + "%";

      document.getElementById("MP").innerHTML =
        "Max: " + response.data.profits * 0.5 + "$";
      document.getElementById("BP").innerHTML =
        "Brian: " + response.data.profits * 0.5 + "$";
    })
    .catch(function (error) {
      console.log(error);
    });
</script>
